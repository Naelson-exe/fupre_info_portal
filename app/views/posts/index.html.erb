<% content_for :title, "University Memos & Announcements" %>

<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="h2">University Memos & Announcements</h1>
  <div class="w-50 ms-auto">
    <%= render 'shared/search_form', query: params[:query], search_scope: :post, url: posts_path %>
  </div>
</div>

<div class="d-flex justify-content-end mb-3">
  <span>Show:</span>
  <div class="dropdown ms-2">
    <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" id="perPageDropdown" data-bs-toggle="dropdown" aria-expanded="false">
      <%= params[:per] || 10 %> per page
    </button>
    <ul class="dropdown-menu" aria-labelledby="perPageDropdown">
      <li><%= link_to "10", url_for(params.permit(:search).merge(per: 10)), class: "dropdown-item" %></li>
      <li><%= link_to "25", url_for(params.permit(:search).merge(per: 25)), class: "dropdown-item" %></li>
      <li><%= link_to "50", url_for(params.permit(:search).merge(per: 50)), class: "dropdown-item" %></li>
    </ul>
  </div>
</div>

<div class="list-group shadow-sm">
  <% if @posts.any? %>
    <% @posts.each do |post| %>
      <div class="list-group-item">
        <div class="d-flex w-100 justify-content-between">
          <h5 class="mb-1">
            <%= link_to post.title, post_path(post), class: "text-decoration-none" %>
            <span class="badge bg-secondary"><%= post.post_type.humanize if post.post_type.present? %></span>
            <%= severity_badge(post.severity) if post.severity.present? %>
          </h5>
          <small class="text-muted">Published on: <%= post.published_at&.to_fs(:long) %></small>
        </div>
        <p class="mb-1"><%= post.summary %></p>
        <%= link_to "Read More â†’", post_path(post), class: "text-primary" %>
      </div>
    <% end %>
  <% else %>
    <%= render 'shared/empty_state',
               title: "No Announcements Found",
               message: "There are currently no announcements or memos. Please check back later." %>
  <% end %>
</div>

<div class="mt-4 d-flex justify-content-center">
  <%== pagy_bootstrap_nav(@pagy) %>
</div>
