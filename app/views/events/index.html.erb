<% content_for :title, "Academic Calendar & Events" %>

<div class="mb-4">
  <h1 class="h1">Academic Calendar & Events</h1>
  <div class="mt-3">
    <%= render 'shared/search_form', query: params[:query], search_scope: :event, url: events_path %>
  </div>
</div>

<div class="d-flex justify-content-end align-items-center mb-3">
  <span>Show:</span>
  <div class="dropdown ms-2">
    <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" id="perPageDropdown" data-bs-toggle="dropdown" aria-expanded="false">
      <%= params[:per] || 10 %> per page
    </button>
    <ul class="dropdown-menu" aria-labelledby="perPageDropdown">
      <li><%= link_to "10", url_for(params.permit(:search).merge(per: 10)), class: "dropdown-item" %></li>
      <li><%= link_to "25", url_for(params.permit(:search).merge(per: 25)), class: "dropdown-item" %></li>
      <li><%= link_to "50", url_for(params.permit(:search).merge(per: 50)), class: "dropdown-item" %></li>
    </ul>
  </div>
</div>

<%# Upcoming Events %>
<h2 class="h4 mb-3">Upcoming Events</h2>
<div class="card mb-5">
  <div class="card-body">
    <ul class="list-unstyled mb-0">
      <% if @upcoming_events.any? %>
        <% @upcoming_events.each do |event| %>
          <%= render 'shared/event_item', event: event %>
        <% end %>
      <% else %>
        <%= render 'shared/empty_state',
                   title: "No Upcoming Events",
                   message: "There are no upcoming events at this time. Please check back later." %>
      <% end %>
    </ul>
  </div>
  <div class="card-footer d-flex justify-content-center">
    <%== pagy_bootstrap_nav(@pagy_upcoming) %>
  </div>
</div>

<%# Past Events %>
<h2 class="h4 mb-3">Past Events</h2>
<div class="card">
  <div class="card-body">
    <ul class="list-unstyled mb-0">
      <% if @past_events.any? %>
        <% @past_events.each do |event| %>
          <%= render 'shared/event_item', event: event %>
        <% end %>
      <% else %>
        <%= render 'shared/empty_state',
                   title: "No Past Events",
                   message: "There are no past events to display." %>
      <% end %>
    </ul>
  </div>
  <div class="card-footer d-flex justify-content-center">
    <%== pagy_bootstrap_nav(@pagy_past) %>
  </div>
</div>
